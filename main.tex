\include{preamble}
\begin{document}

\title{Chern-Simons axion angle in the projection gauge}

\author{Trey Cole}
\affiliation{
Department of Physics \& Astronomy, Rutgers University,
Piscataway, New Jersey 08854, USA}

\author{David Vanderbilt}
\affiliation{
Department of Physics \& Astronomy, Rutgers University,
Piscataway, New Jersey 08854, USA}

\begin{abstract}
The Chern-Simons axion angle $\theta$ is given by a Brillouin-zone integral of the Chern-Simons 3-form and requires a smooth, periodic gauge for the occupied Bloch states in order for the integral to be numerically evaluated stably. In practice, one often enforces smoothness via the projection method and then evaluates the non-Abelian Berry connection in the projection gauge, $\tilde{\mathcal{A}}_\mu$, using finite differences on dense $k$-meshes, which is numerically fragile and sensitive to gauge discontinuities. Here we show that $\tilde{\mathcal{A}}_\mu$ can instead be obtained \emph{analytically} at each $k$ point from a Sylvester-equation solution involving the singular values and singular vectors of the overlap matrix between Bloch states and trial orbitals. The resulting expression is a single-point, Kubo-like formula that eliminates finite differences and overlaps between neighboring $k$ points. We demonstrate the method on the Fu-Kane-Mele tight-binding model, where a cyclic symmetry-breaking modulation pumps $\theta$ from $0$ to $2\pi$ in accord with the nontrivial second Chern number.
\end{abstract}

\maketitle

\noindent

\section{Introduction}
The Chern-Simons axion angle $\theta$ is a geometric property of the occupied Bloch states of a three-dimensional insulator. It is defined modulo $2\pi$ and can be expressed as a Brillouin-zone integral of the Chern-Simons 3-form constructed from the non-Abelian Berry connection. While $\theta$ plays a central role in magnetoelectric response theory and in the topological classification of insulating phases, its direct numerical evaluation is nontrivial. The difficulty stems from the fact that the Chern-Simons integrand is not gauge-covariant, so the computed value of $\theta$ depends sensitively on the smoothness and periodicity of the chosen Bloch-state gauge throughout the Brillouin zone.

Explicitly, the Chern-Simons axion angle is given by \cite{chern1974characteristic, Malashevich_2010, mong2010antiferromagnetic, essin2010orbital}
\begin{equation}
\label{eq:CS3form}
 \theta = -\frac{1}{4\pi} \int_{\text{BZ}} d^3k \,
\epsilon^{\mu\nu\sigma} \mathrm{Tr} \left[
    \mathcal{A}_\mu \partial_\nu \mathcal{A}_\sigma
    - \frac{2i}{3} \mathcal{A}_\mu \mathcal{A}_\nu \mathcal{A}_\sigma
\right],
\end{equation}
where $\mathcal{A}_\mu$ is the non-Abelian (multiband) Berry connection,
\begin{equation}
    (\mathcal{A}_\mu)_{nm} = i\langle u_{n\mathbf{k}} | \partial_{k_\mu} u_{m\mathbf{k}} \rangle .
\end{equation}
Here, $|u_{n\mathbf{k}}\rangle$ denotes the cell-periodic Bloch states, the indices $(n,m)$ run over the occupied bands, and $\partial_{k_\mu}$ denotes differentiation with respect to the $\mu$th Cartesian component of crystal momentum.

Under a smooth gauge transformation of the occupied subspace,
\begin{equation}
    |\tilde{u}_{n\mathbf{k}}\rangle = U_{nm}(\mathbf{k}) |u_{m\mathbf{k}}\rangle ,
\end{equation}
the Berry connection transforms as
\begin{equation}
\label{eq:tildeA}
    \tilde{\mathcal{A}}_\mu
    = U^\dagger \mathcal{A}_\mu U + i U^\dagger \partial_{k_\mu} U .
\end{equation}
As a consequence, the Chern-Simons integral in Eq.~\ref{eq:CS3form} is invariant only modulo $2\pi$, giving $\theta$ the interpretation of an angular variable. In the presence of time-reversal or inversion symmetry, this ambiguity reduces to a quantization of $\theta$ in integer multiples of $\pi$, with odd (even) multiples corresponding to an odd (even) strong $\mathbb{Z}_2$ topological index in three dimensions \cite{essin2010orbital, qi2008topological, coh2011chern}. More generally, any cyclic adiabatic evolution of the Bloch Hamiltonian $H(\mathbf{k},\lambda)$ whose associated second Chern number in $(\mathbf{k},\lambda)$ space is nonzero will pump $\theta$ by an integer multiple of $2\pi$ \cite{essin2010orbital, taherinejad2015adiabatic}.

From a numerical standpoint, evaluating Eq.~\ref{eq:CS3form} requires the construction of a smooth and periodic gauge for the occupied Bloch states over the Brillouin zone. In contrast to Berry curvatures and other gauge-covariant quantities, the explicit dependence of the Chern-Simons 3-form on the Berry connection makes straightforward finite-difference approaches highly sensitive to random phases, gauge discontinuities at Brillouin-zone boundaries, and band crossings. These issues significantly complicate first-principles implementations and can lead to poor convergence unless extremely dense $k$-meshes are used.

This situation is closely analogous to that encountered in the modern theory of electric polarization, where the polarization itself is defined only modulo a quantum. In one dimension, the electronic polarization can be written in the discretized, gauge-invariant form
\begin{equation}
    P = \frac{e}{2\pi} \mathrm{Im}\,\ln \det
    \left[ M_{k_1 k_2} M_{k_2 k_3} \cdots M_{k_{M-1} k_M} \right],
\end{equation}
with overlap matrices $(M_{k k'})_{mn} = \langle u_{m\mathbf{k}} | u_{n\mathbf{k}'} \rangle$.
The gauge invariance follows from the properties of the determinant. No analogous fully gauge-invariant discretized expression exists for the Chern-Simons 3-form except in the single-band case \cite{coh2011chern}, making the identification of a smooth gauge an essential prerequisite.

The requirement of a smooth gauge is equally crucial when attempting to compute the Berry connection itself using finite differences. Such approaches rely on a continuous labeling of bands across the Brillouin zone and break down in the presence of band crossings or gauge discontinuities, where the notion of a ``neighboring state'' becomes ambiguous.

The problem of constructing a smooth and periodic gauge is closely related to the construction of well-localized Wannier functions. Accordingly, several approaches based on Wannier and hybrid Wannier representations have been developed to compute the Chern-Simons axion angle \cite{coh2011chern, olsen2017surface, varnava2020axion}. An alternative, explicitly gauge-invariant formulation expresses changes in $\theta$ during an adiabatic evolution in terms of the four-dimensional Berry curvature (4-curvature) \cite{essin2010orbital, taherinejad2015adiabatic}.

In this work, we derive an expression for $\theta$ directly in the projection gauge commonly employed in Wannierization procedures. Given an appropriate choice of trial orbitals, the projection method yields a smooth and periodic gauge by construction. We show that the corresponding non-Abelian Berry connection can be obtained analytically at each $\mathbf{k}$ point, leading to a single-point, Kubo-like expression for $\theta$ that avoids finite differences and overlaps between neighboring $\mathbf{k}$ points. The resulting formulation is both numerically robust and free from gauge-discontinuity issues.


An arbitrary gauge-transformation leaves Eq.~\ref{eq:CS3form} invariant only modulo $2\pi$, giving $\theta$ the interpretation of a phase angle. In the presence of time-reversal or inversion symmetry, $\theta$ is quantized to be an integer multiple of $\pi$ with an odd (even) value corresponding to an odd (even) strong $\mathbb{Z}_2$ topological index of a 3D topological insulator \cite{essin2010orbital, qi2008topological, coh2011chern}. Another interesting consequence of the $2\pi$ ambiguity is that any periodic adiabatic evolution of the Bloch Hamiltonian $H(k,\lambda)$ whose second Chern number in $(k, \lambda)$ space is nonzero will change $\theta$ by $2\pi$ \cite{essin2010orbital, taherinejad2015adiabatic}.

The numerical evaluation of the Chern-Simons axion angle $\theta$ requires constructing a smooth and periodic gauge for the occupied Bloch states over the Brillouin zone. Unlike Berry curvatures or other gauge-covariant quantities, the Chern-Simons 3-form depends explicitly on the non-Abelian Berry connection, making straightforward finite-difference approaches highly sensitive to gauge discontinuities, random phases, and band crossings. These difficulties have limited the robustness and efficiency of existing first-principles implementations.

The cell-periodic wavefunctions obtained from electronic structure calculations generically do not have a special gauge choice and appear with random phases across the Brillouin zone (BZ). This enters in Eq.~\ref{eq:CS3form} through the fact that the non-Abelian connection is not gauge-covariant. A gauge change of the cell-periodic wavefunctions,
\begin{equation}
    |\tilde{u}_{nk}\rangle = U_{nm}(k) |u_{mk} \rangle
\end{equation}
changes the non-Abelian connection as 
\begin{equation}
\label{eq:tildeA}
    \tilde{\mathcal{A}}_{\mu} = U^{\dagger} \mathcal{A}_\mu U + iU^\dagger \parmu U
\end{equation} 
All the terms produced by the gauge transformation in Eq.~\ref{eq:CS3form} cancel except a multiple of $2\pi$, leaving the ground state dynamics unchanged. 

This is to be compared to the case of electric polarization, which has a similar ambiguity modulo a polarization ``quantum" that counts the number of times $U(k)$ winds around the BZ. In one dimension, the electronic polarization can be computed as,
\begin{equation}
    P = \frac{e}{2\pi} \text{Im} \ln \det \left[ M_{k1, k2} M_{k2, k3} \cdots M_{k_{M-1} k_M}\right]
\end{equation}
where the overlap matrix is defined as $(M_{kk'})_{mn} = \langle u_{mk} | u_{nk'} \rangle $.
This form of the polarization is gauge-invariant because of the properties of the determinant. Except in the single-band case, there is not a gauge-invariant discretized formula for the integral of the Chern-Simons 3-form \cite{coh2011chern}. The calculation of the Chern-Simons 3-form requires that we first identify a smooth gauge on the k-mesh. 

A smooth gauge is also needed when trying to compute $\tilde{A}_\mu$ directly from finite differences. The finite differences between neighboring states will only be meaningful in the gauge is continuous within the BZ and across BZ boundaries. The issue is even worse in the presence of band crossings, where the choice of neighboring state is ambiguous.

The problem of constructing a smooth gauge is equivalent to the problem of finding well-localized Wannier functions. Thus, several approaches to compute the Chern-Simons axion angle based on Wannier and hybrid Wannier functions have been put forth \cite{coh2011chern, olsen2017surface, varnava2020axion}. An alternative gauge-invariant formulation allows one to compute the axion pumping relative to a known ground state using the 4-curvature \cite{essin2010orbital, taherinejad2015adiabatic}.

In this paper, we seek to derive an expression for $\theta$ from the projection gauge commonly used in Wannierization routines. This produces a smooth and periodic gauge given a suitable choice of trial wavefunctions. Notably, we find an expression that is free of any finite difference overlaps at neighboring $k$-points, giving an exact Kubo-like expression for each $k$-point. This is both more numerically stable and free of any gauge-discontinuity issues.

\section{Projection gauge}

The projection method allows one to fix a smooth gauge choice by projecting the Bloch states onto a set of trial orbitals,  $|g_n\rangle$, that resemble the Bloch states in character. We define the overlap matrix between the Bloch wavefunctions and the trial orbitals,  
\begin{equation}
\label{eq:ovlp}
     S_{mn}(k) = \langle \psi_{mk}|g_n\rangle,\quad m\in \rm occ .
\end{equation}
To obtain the closest unitary matrix to this matrix, we use the singular value decomposition, 
\begin{equation}
\label{eq:SVD}
    S = W\Sigma V^\dagger
\end{equation}
Equivalently, this can be thought of as a polar decomposition of $S$ into a unitary part $U$ and a positive semi-definite part $P$,
\begin{align}
\label{eq:polar}
    S &= UP, \\
\label{eq:polarU}
    U &= W V^\dagger, \\
\label{eq:polarP}
    P &= (S^\dagger S)^{1/2} = V \Sigma V^\dagger .
\end{align}
With the unitary part in hand, the Bloch-like states in the projection gauge are 
\begin{equation}
\label{eq:psitil}
    |\tilde{\psi}_{nk} \rangle = \sum_{m} U_{mn}(k) | \psi_{mk} \rangle 
\end{equation}
In the case where the Bloch states are free of any topological obstruction, and our choice of trial wavefunctions has suitable support on the manifold of Bloch states, these rotated Bloch-like states will have a smooth gauge \cite{marzari1997, marzari2012}. 

We note in passing that the topological obstructions encountered in the systems of interest regarding the Chern-Simons axion angle are those of a time-reversal invariant topological insulator. These obstructions can be circumvented by choosing a set of trial wavefunctions that are not Kramers pairs and break time reversal symmetry \cite{soluyanov2011}.

\section{Non-Abelian connection in the projection gauge}

In order to compute the Chern-Simons 3-form Eq~\ref{eq:CS3form}, we first need to obtain the non-Abelian connection in the projection gauge. The gauge rotation produces an extra factor $U^{\dagger}\parmu U$ in Eq.~\ref{eq:tildeA} that will be our primary focus. We later show that the connection in the original ``Hamiltonian" gauge of the energy eigenstates ($A_\mu$) drops out of the final equation for $\tilde{A}_\mu$.

We begin by differentiating Eq.~\ref{eq:polar},
\begin{equation}
    \parmu S = (\parmu U) P + U (\parmu P)
\end{equation}
Multiplying on the right by $P^{-1}$ and on the left by $U^\dagger$, and rearranging, gives
\begin{equation}
\label{eq:udagparmu}
    U^{\dagger} \parmu U = U^{\dagger} ( \parmu S)P^{-1}  - (\parmu P ) P^{-1}
\end{equation}
Thus, determining $U^{\dagger}\partial_{\mu} U$ requires closed-form expressions for $\partial_{\mu} S$ and $\partial_{\mu} P$. We further seek an expression that only depends on quantities at the same crystal momentum $k$, avoiding any finite difference approximations for derivatives of the Bloch states. 

From the definition of $S$ in Eq.~\ref{eq:ovlp},
\begin{equation}
\label{eq:derivS}
    (\parmu S)_{mn} = \langle \parmu \psi_{mk} | g_n \rangle, \quad m\in\text{occ}
\end{equation} 
Differentiating the Bloch eigenstate,
\begin{equation}
    |\parmu \psi_{mk} \rangle = ir_{\mu} |\psi_{mk} \rangle + e^{i k\cdot r} |\parmu u_{mk} \rangle 
\end{equation}
The derivative of the cell-periodic part can be obtained from first-order adiabatic perturbation theory,
\begin{equation}
\label{eq:first-order}
    |\parmu u_{mk} \rangle = \sum_{l \notin occ} |u_{lk} \rangle\frac{ \langle u_{lk}| \partial_{\mu} H_k |u_{mk} \rangle}{E_{mk} - E_{lk}}  - i \sum_{n \in occ} \mathcal{A}_{mn, \mu} |u_{nk} \rangle 
\end{equation}
Plugging Eq.~\ref{eq:first-order} into Eq.~\ref{eq:derivS} and using Hermiticity of the non-Abelian Berry connection $\mathcal{A}_{mn, \mu} = \mathcal{A}_{mn, \mu}^{*}$ gives, 
\begin{align}
 (\parmu S)_{mn} = -i \langle \psi_{mk}| r_{\mu} | g_n\rangle  + i \sum_{l \in occ} \mathcal{A}_{ml, \mu}S_{ln} +  \\ \nonumber \sum_{l \notin \rm occ} \frac{\langle u_{mk} | \parmu H_k | u_{lk} \rangle}{E_{mk} - E_{lk}}  \langle \psi_{lk} | g_n\rangle 
\end{align}
For convenience, we define the complementary overlap matrix as the projection of the trial orbitals onto the conduction states,
\begin{equation}
\label{eq:ovlp_con}
     S_{mn}^{\perp}(k) = \langle \psi_{mk}|g_n\rangle,\quad m\in \rm con,
\end{equation}
and the following matrices,
\begin{align}
    \mathcal{R}_{mn} &= \langle \psi_{mk}| r_{\mu} | g_n\rangle, \quad m \in \text{occ}  \\
    \mathcal{V}_{mn} &= \frac{\langle u_{mk} | \partial_{\mu} H | u_{nk} \rangle}{E_{mk} - E_{nk}}, \quad m \in \text{occ}, \ n\notin \text{occ}
\end{align}
This allows us to express the derivative of the overlap matrix as a matrix equation,
\begin{equation}
\label{eq:matparmus}
    \parmu S = -i \mathcal{R}_{\mu} + i \mathcal{A}_\mu S + \mathcal{V}_{\mu} S^{\perp}
\end{equation}
Each term, $\mathcal{R}_{\mu}$, $\mathcal{V}_{\mu}$, $S$, and $S^\perp$ are known for a given $k$ point. Only the $\mathcal{A}_{\mu}$ requires the use of finite differences, and as we will show below, this contribution cancels out in the final form. Below, we aim to derive a similar single-point form for $\parmu P$ to get $\tilde{\mathcal{A}}_{\mu}$ analytically.

We now seek a closed, single–point expression for $\parmu P$. From the polar factor $P=(S^\dagger S)^{1/2}$ it follows that
\begin{equation}
\label{eq:parmuP_master}
    P(\parmu P)+(\parmu P)P \;=\; \parmu(S^\dagger S)
    \;=\; S^\dagger(\parmu S)+(\parmu S)^\dagger S.
\end{equation}
After substituing \eqref{eq:matparmus},
the anti-Hermitian term proportional to $i\mathcal{A}_\mu$ on the right-hand side of Eq.~\eqref{eq:parmuP_master} drops out, yielding
\begin{align}
\label{eq:parmuP_Sylvester_rhs}
    P(\parmu P)+(\parmu P)P
    \;=\; \mathrm{sym}\!\left\{ S^\dagger\!\left(-i\,\mathcal{R}_\mu + \mathcal{V}_\mu S^\perp\right)\right\},
\end{align}
where $\mathrm{sym}\,Y \equiv Y+Y^\dagger$. This is a Sylvester equation of the form $PX + XP = Y$ for $X$.

\paragraph*{Sylvester operator.}
Define the Sylvester map $\mathcal{L}_P:\,X\mapsto PX+XP$. If this map is invertible, then we denote its inverse by $\mathcal{L}_P^{-1}$. Then the \emph{single–point} solution of Eqs.~\eqref{eq:parmuP_master}–\eqref{eq:parmuP_Sylvester_rhs} is
\begin{align}
\label{eq:dP_basisfree_final}
    \parmu P
    \;=\;
    \mathcal{L}_P^{-1}\!\left[
        \mathrm{sym}\!\left\{ S^\dagger\!\left(-i\,\mathcal{R}_\mu + \mathcal{V}_\mu S^\perp\right)\right\}
    \right].
\end{align}
Equation \eqref{eq:dP_basisfree_final} depends only on \emph{single–$k$} objects ($\mathcal{R}_\mu$, $\mathcal{V}_\mu$, $S^\perp$) and is therefore free of gauge–discontinuity issues.

\paragraph*{Existence of the inverse.}
From Eq.~\ref{eq:polarP}, the spectral decomposition of $P$ is given as $P=V\Sigma V^\dagger$, with $\Sigma$ being the matrix of singular values and $V$ being the right unitary from the SVD. Since $P$ is positive semi-definite, its eigenvalues (the singular values) $\Sigma=\mathrm{diag}(\sigma_1,\dots,\sigma_N)\ge 0$. The action of $\mathcal{L}_P^{-1}$ in the $\Sigma$–diagonal frame is
\begin{equation}
\label{eq:Linv_component_rule}
    \mathcal{L}_P^{-1}[Y]
    \;=\;
    V\!\left[\frac{\,V^\dagger Y V\,}{\sigma_i+\sigma_j}\right]\!V^\dagger,
\end{equation}
where the division is componentwise. The inverse mapping, and thus $\parmu P$, is uniquely defined on the support of $P$ if $\sigma_i+\sigma_j \neq 0$. Due to positive semi-definiteness, singular values with $\sigma_i + \sigma_j = 0$ must have $\sigma_i=\sigma_j=0$, which correspond to trial states with no support on the occupied subspace. This could be the consequence of poorly chosen trial wavefunctions or signal the presence of a topological obstruction to a globally smooth projection gauge.

\paragraph*{Component form (used in numerics).}
Applying \eqref{eq:Linv_component_rule} to \eqref{eq:dP_basisfree_final} gives the explicit single–point expression
\begin{align}
\label{eq:dP_component_final}
    \parmu P
    \;=\;
    V\!\left[
        \frac{
            V^\dagger S^\dagger\!\left(-i\,\mathcal{R}_\mu + \mathcal{V}_\mu S^\perp\right)\!V
            \;+\;\text{h.c.}
        }{\sigma_i+\sigma_j}
    \right]\!V^\dagger,
\end{align}
which is the form we employ in implementations. (A derivation via diagonalizing $P$ is provided in the Appendix \ref{apdx:sylvester} for completeness.)


Combining Eqs.~\eqref{eq:tildeA}, ~\eqref{eq:udagparmu}, and ~\eqref{eq:matparmus} gives,
\begin{align}
    \label{eq:tildeA_prelim}
    \tilde{\mathcal{A}}_\mu
    = U^\dagger \mathcal{A}_\mu U
       +  i\left[ U^\dagger\!\left(-\,i\mathcal{R}_\mu + i\,\mathcal{A}_\mu S + \mathcal{V}_\mu S^\perp\right) -(\partial_\mu P) \right]\,P^{-1}
\end{align}
Since $S=UP$, we have $U^\dagger \mathcal{A}_\mu S P^{-1} = U^\dagger \mathcal{A}_\mu U$, hence the $\mathcal{A}_\mu$ terms cancel, giving
\begin{align}
    \tilde{\mathcal{A}}_\mu
    &= i\,U^\dagger \left( -i\,\mathcal{R}_\mu  + \mathcal{V}_\mu S^\perp \right)P^{-1}
       - i\,(\partial_\mu P)P^{-1}.
    \label{eq:tildeA_after_cancel}
\end{align}
Using Eq.~\eqref{eq:dP_basisfree_final}, we can express $\tilde{\mathcal{A}}_\mu$ only in terms of $\mathcal{R}_\mu$ and the Kubo-like term $\mathcal{V}_\mu$,
\begin{align}
    \label{eq:tildeA_compact}
    \tilde{\mathcal{A}}_\mu
    &= i\, U^\dagger \big(-i\,\mathcal{R}_\mu + \mathcal{V}_\mu S^\perp\big) P^{-1}
       \;-\;
       \\
       \nonumber
       &
       i\,\mathcal{L}_P^{-1}
       \!\left(
           \, \mathrm{sym}\!\big\{ S^\dagger\big(-i\,\mathcal{R}_\mu + \mathcal{V}_\mu S^\perp\big) \big\}
       \right)
       P^{-1}.
\end{align}
In explicit component form, it is
\begin{align}
\label{eq:tildeA_comp}
    \tilde{\mathcal{A}}_\mu
    &=  i\, U^\dagger \left( -i\, \mathcal{R}_\mu  +  \mathcal{V}_\mu S^\perp \right)P^{-1}
       \nonumber\\
    &\quad
       -
       i\, V\left[
        \frac{
            V^\dagger S^\dagger\!\left(-i\,\mathcal{R}_\mu + \,\mathcal{V}_\mu S^\perp\right)\!V
            + \text{h.c.}
        }{\sigma_i+\sigma_j}
       \right]V^\dagger P^{-1}. \
\end{align}

This is the non-Abelian Berry connection in the projection gauge using only single-point quantities ($\mathcal{R}_{\mu}$, $\mathcal{V}_\mu$), obviating the need for finite-difference approximations.

\section{Axion angle from Chern-Simons 3-form}

We consider the Fu-Kane-Mele (FKM) model for a three-dimensional topological insulator with time-reversal ($\mathcal{T}$) and inversion ($\mathcal{P}$) symmetries that quantize the axion angle $\theta=\pi$. We introduce a parameter $\beta$ that enters the Hamiltonian through a staggered Zeeman field and hopping modulation along the $(111)$ direction. This parameter breaks the $\theta$-quantizing symmetries when its value $\beta \neq n\pi, \; n\in \mathbb{Z}$.

For the calculations below, we implement the tight-binding model with the PythTB package \cite{Cole_Python_Tight_Binding_2025}, and compare the axion angle computed with the Chern-Simons 3-form implemented above with the gauge-invariant four curvature formulation implemented in PythTB.

The FKM takes the second quantized form,

\begin{equation}
    \label{eq:FKM}
     H = t \sum_{\langle ij \rangle} c_i^{\dagger} c_j
        + i\ \lambda_{SO} \sum_{\langle\langle ij \rangle\rangle} c_i^{\dagger}
        \vec{\sigma} \cdot (\mathbf{d}_{ij}^{1} \times \mathbf{d}_{ij}^{2}) c_j
\end{equation}

where the first term is a nearest-neighbor hopping term connecting the two fcc sublattices of the diamond lattice, and the second term is a spin-orbit coupling term connecting second-neighbor sites within the same sublattice. Here, $\mathbf{d}_{ij}^{1,2}$ are the two nearest-neighbor bond vectors connecting sites $i$ and $j$. Due to inversion symmetry, each band is doubly degenerate. The degeneracy is lifted by the symmetry-lowering perturbation of the nearest-neighbor hopping along the $(111)$ direction $t \rightarrow t + \beta\ \delta t_p$. In addition to inversion, the model also has time-reversal symmetry, which will quantize $\theta$. To break time-reversal, we also include 
a time-reversal symmetry-breaking perturbation proportional to $\beta$ that enters the Hamiltonian as a staggered Zeeman field on the $A$ and $B$ sublattices. 

Next, we will compute the axion angle using both the $3$-form derived here and the $4$-curvature as a function of the adiabatic parameter. At $\beta=\pi$, the system is in the topologically non-trivial phase and we chose trial wavefunctions that break time-reversal symmetry. Fig.\ref{fig:#1} shows the numerical computation of the axion angle, showing that both forms agree. 

\section{Discussion}

We have derived a fixed-$k$ Kubo-like expression for the Berry connection in the projection gauge and used it to compute the Chern-Simons axion angle from the Chern-Simons 3-form in the Fu-Kane-Mele model. By eliminating finite-difference derivatives in favor of a single-point Sylvester-equation solution, the method sidesteps the usual gauge-discontinuity issues and reduces the sensitivity to the choice of $k$-mesh. The numerical comparison with the gauge-invariant four-curvature formulation confirms that the single-point expression reproduces the correct axion pumping by $2\pi$ over a nontrivial adiabatic cycle.

While our focus here has been on the axion angle, the central object is the projection-gauge connection $\tilde{\mathcal{A}}_\mu$ itself. In practice, a large class of Berry-phase and Berry-curvature-based response formulas can be written in terms of the connection (and/or its derivatives) in any smooth gauge. Examples include orbital magnetization, anomalous Hall conductivity, optical responses, nonlinear Hall effects, Berry-curvature dipoles, and higher-order multipole responses. In Wannier-based workflows, these are typically evaluated either in a Hamiltonian gauge with explicit interband velocity matrix elements, or in a Wannier gauge with overlaps between neighboring $k$-points. The present construction offers a third route: once the projection gauge has been constructed, one can obtain $\tilde{\mathcal{A}}_\mu$ at each $k$ using only (i) matrix elements of position or velocity in the original eigenstate basis and (ii) the overlap matrix $S$ to the trial orbitals. This suggests that many response quantities could be reformulated in a numerically robust way using the same single-point machinery developed here.

An immediate application is to Wannier-based post-processing codes that already rely on the projection method or on Wannier90-like workflows. In such codes, the overlap $S$ and its singular-value structure are already available as part of the disentanglement and maximally localized Wannierization. Our results show that the same ingredients can be recycled to construct $\tilde{\mathcal{A}}_\mu$ without ever forming finite differences between neighboring $k$-points. This is particularly attractive on irregular meshes, adaptive meshes, or meshes aligned to Fermi surfaces, where defining a consistent set of ``neighbors'' is awkward. It can also simplify parallelization strategies, since each $k$-point can be treated independently given access to the relevant eigenstates and trial orbitals.

It is also tempting to consider generalizations to higher-order geometric objects. The present formalism provides a clean single-point expression for the connection; by differentiating once more with respect to $k$, one may hope to construct a similarly well-conditioned expression for the quantum metric and curvature tensor in the projection gauge, again without finite differences. Since the quantum metric has recently emerged as a key ingredient in flat-band superconductivity, superfluid weight, and fractional Chern insulators, such a formulation could open a path to more stable calculations of quantum-geometric response functions within Wannier-based codes, in close analogy to the axion-angle calculation presented here. We expect that exploring these generalizations, and recasting other Berry-phase-based observables in terms of the projection-gauge connection, will be a fruitful direction for future work.

\appendix

\section{Hermiticity of non-Abelian Berry connection}
\begin{align}
    &\langle u_{mk} | u_{nk} \rangle = 0 \rightarrow \parmu \langle u_{mk} | u_{nk} \rangle =0 \\
    & \langle u_{mk} | \parmu u_{nk} \rangle = -\langle \parmu u_{mk} | u_{nk} \rangle = -\langle u_{nk} | \parmu u_{mk} \rangle ^*\\
    &   A_{\mu, mn}^{\dagger} = A_{\mu,nm}^* = -i\langle u_{nk} | \parmu u_{mk} \rangle^* = i\langle u_{mk} | \parmu u_{nk} \rangle = A_{\mu, mn}
\end{align}

\section{Deriving the Sylvester equation solution}
\label{apdx:sylvester}
We know from the polar decomposition \eqref{eq:polarP} that $PP = S^{\dagger} S$. Differentiating this, we get
\begin{equation}
\label{eq:parmuP_og}
    P(\parmu P) + (\parmu P)P = \parmu(S^{\dagger} S)
\end{equation}
This is a Sylvester equation of the form $AX + XA = B$ for $X$. We can solve this by transforming into the eigenbasis of $P$. Since $P$ is Hermitian by definition, this transformation always exists, $P = V \Sigma V^{\dagger}$ where $V$ is the right unitary and $\Sigma = \textrm{diag}(\sigma_1, \sigma_2, \cdots )$ is the matrix of singular values from the SVD in Eq.~\ref{eq:SVD}. Substituting the spectral decomposition of $P$ into Eq.~\ref{eq:parmuP_og} we get, 
\begin{equation}
\label{eq:eigdecomp}
    (V\Sigma V^{\dagger})(\parmu P) + (\parmu P) (V \Sigma V^{\dagger} ) = S^{\dagger} \parmu S + (\parmu S^{\dagger}) S
\end{equation}

Focusing on the RHS of Eq.~\ref{eq:eigdecomp}, after substituting Eq.~\ref{eq:matparmus} we have,
\begin{equation}
    S^{\dagger} \parmu S + (\parmu S^\dagger)S = -i S^{\dagger} \mathcal{R}_\mu + i S^\dagger \mathcal{A}_{\mu}S + S^{\dagger}\mathcal{V}_\mu S^{\perp} + \text{h.c.}
\end{equation}
Since $S^\dagger \mathcal{A}_{\mu}S$ is Hermitian, $iS^\dagger \mathcal{A}_{\mu}Su$ is anti-Hermitian, and the terms involving the Berry connection in the Hamiltonian gauge cancel out.

Returning to Eq.~\ref{eq:eigdecomp}, we multiply $V^{\dagger}$ from the left and $V$ from the right,
\begin{align}
    &\Sigma \,(V^{\dagger}\,\partial_\mu P\,V)
    + (V^{\dagger}\,\partial_\mu P\,V)\,\Sigma
    \nonumber\\
    &= 
    -\,i\,V^{\dagger} S^{\dagger}\mathcal{R}_\mu V
    \;+\;
    V^{\dagger} S^{\dagger}\mathcal{V}_\mu S^{\perp} V
    + \text{h.c.}
    \label{eq:sylvester_raw}
\end{align}
Using the common factor $V^\dagger S^\dagger(\cdots)V$, this may be written
\begin{align}
    &\Sigma \,(V^{\dagger}\,\partial_\mu P\,V)
    + (V^{\dagger}\,\partial_\mu P\,V)\,\Sigma
    \nonumber\\
    &= 
    V^\dagger S^\dagger
    \!\left(-i\,\mathcal{R}_\mu + \mathcal{V}_\mu S^{\perp}\right)\!
    V
    + \text{h.c.}
    \label{eq:sylvester_factored}
\end{align}
Temporarily defining
\begin{equation}
P_{\mu}^{\prime}
\equiv
V^{\dagger}(\partial_\mu P)\,V ,
\end{equation}
we obtain the Sylvester equation
\begin{equation}
\label{eq:sylvester_Pprime}
    \Sigma\,P_{\mu}^{\prime}
    +
    P_{\mu}^{\prime}\,\Sigma
    =
    V^\dagger S^\dagger\!
    \left(-i\,\mathcal{R}_\mu + \mathcal{V}_\mu S^{\perp} \right)
    V
    + \text{h.c.}
\end{equation}
Since $\Sigma_{ij} = \sigma_i\delta_{ij}$, the component form is
\begin{equation}
\label{eq:Pprime_comp}
    (\sigma_i+\sigma_j)
    (P^{\prime}_{\mu})_{ij}
    =
    \left[
        V^\dagger S^\dagger
        \left( -i\,\mathcal{R}_\mu + \mathcal{V}_\mu S^{\perp} \right)
        V
    \right]_{ij}
    + \text{h.c.}
\end{equation}
so that
\begin{equation}
\label{eq:Pprime_sol}
    (P^{\prime}_{\mu})_{ij}
    =
    \frac{
        \left[
            V^\dagger S^\dagger
            \left( -i\,\mathcal{R}_\mu + \mathcal{V}_\mu S^{\perp} \right)
            V
        \right]_{ij}
        + \text{h.c.}
    }{
        \sigma_i+\sigma_j
    }.
\end{equation}
Transforming back to the original basis,
\begin{equation}
\label{eq:dP_final}
    \partial_\mu P
    =
    V\,P'_\mu\,V^\dagger
    =
    V\,
    \left[
    \frac{
        V^\dagger S^\dagger
        \left( -i\,\mathcal{R}_\mu + \mathcal{V}_\mu S^{\perp} \right)
        V
        + \text{h.c.}
    }{
        \sigma_i+\sigma_j
    }
    \right]
    V^\dagger .
\end{equation}
Here, the division by $(\sigma_i+\sigma_j)$ is understood elementwise in the $\Sigma$–diagonal basis.

\bibliography{ref}

\end{document}
